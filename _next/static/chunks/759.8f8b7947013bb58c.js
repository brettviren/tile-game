"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{7565:function(t,e,n){n.d(e,{$c:function(){return b},Pw:function(){return w},TZ:function(){return p},WR:function(){return i},hJ:function(){return x},hr:function(){return l},pJ:function(){return v},x0:function(){return u}});var r=n(3487);function a(){return Math.floor(4*Math.random())+1}function u(){return{id:Math.random(),value:a(),removed:!1}}function o(t,e){let{x:n,y:r}=t;return r*e.length+n}function i(t){let e=Array.from({length:t}).map(e=>Array.from({length:t}).map(t=>u())),n=m(e);for(;n.length>0;){for(let t of n){let{x:n,y:r}=t.origin;e[n][r]={...e[n][r],value:a()}}n=m(e)}return e}function l(t){return t.slice().map(t=>t.slice())}function f(t,e){return t.x==e.x&&1==Math.abs(t.y-e.y)||t.y==e.y&&1==Math.abs(t.x-e.x)}function c(t,e){let n=e[t.x][t.y],r=function(t,e){let n=[],r=e[t.x][t.y];for(let a=t.y-1;a>=0&&e[t.x][a].value==r.value;a--)n=[...n,{x:t.x,y:a}];return n}(t,e),a=function(t,e){let n=[],r=e[t.x][t.y];for(let a=t.y+1;a<e[t.x].length&&e[t.x][a].value==r.value;a++)n=[...n,{x:t.x,y:a}];return n}(t,e),u=function(t,e){let n=[],r=e[t.x][t.y];for(let a=t.x-1;a>=0&&e[a][t.y].value==r.value;a--)n=[...n,{x:a,y:t.y}];return n}(t,e),o=function(t,e){let n=[],r=e[t.x][t.y];for(let a=t.x+1;a<e.length&&e[a][t.y].value==r.value;a++)n=[...n,{x:a,y:t.y}];return n}(t,e),i=r.length+a.length,l=u.length+o.length,f=[];i>=2&&(f=[...f,...r,...a]),l>=2&&(f=[...f,...o,...u]);let c=f.length;return 0==c?{match:!1}:{newValue:n.value+c-1,matchedTiles:f,origin:t,match:!0}}function s(t,e,n){let r=l(n);if(r[e.x][e.y]=n[t.x][t.y],r[t.x][t.y]=n[e.x][e.y],!f(t,e)||!c(t,r).match&&!c(e,r).match)return[{board:r,points:0},{board:n,points:0}];let a=l(r),u=c(t,a),o=c(e,a),i=[];u.match&&(a[t.x][t.y]={...a[t.x][t.y],value:u.newValue},i.push(u)),o.match&&(a[e.x][e.y]={...a[e.x][e.y],value:o.newValue},i.push(o));let s=h(i,a),m=function(t){let e=[],n=y(t),r=l(t);for(;n.length>0;){let t=l(r);for(let e of n){let{x:n,y:r}=e.origin;t[n][r]={...t[n][r],value:e.newValue}}let a=h(n,t);e=[...e,{board:t,points:n.reduce((t,e)=>Math.pow(2,e.newValue)+t,0)},...a.map(t=>({board:t,points:0}))],n=y(a[1]),r=a[1]}return e}(s[1]);return[{board:r,points:0},{board:a,points:i.reduce((t,e)=>Math.pow(2,e.newValue)+t,0)},...s.map(t=>({board:t,points:0})),...m]}function h(t,e){let n=l(e);for(let e of t)for(let{x:t,y:r}of e.matchedTiles)n[t][r]={...n[t][r],removed:!0,mergedTo:e.origin};let r=l(e);for(let n=0;n<e.length;n++){let a=0;for(let u=e[n].length-1;u>=0;u--){if(t.map(t=>t.matchedTiles).flat().find(t=>t.x==n&&t.y==u)){a+=1;continue}r[n][u+a]=e[n][u]}for(let t=0;t<a;t++)r[n][t]=u()}return[n,r]}function y(t){let e=m(t).map(t=>({position:t.origin,...t})).sort((t,e)=>e.newValue-t.newValue),n=new Set,r=[];for(let a of e)n.has(o(a.position,t))||a.matchedTiles.some(e=>n.has(o(e,t)))||(n.add(o(a.position,t)),a.matchedTiles.forEach(e=>{n.add(o(e,t))}),r=[...r,a]);return r}function m(t){return t.map((e,n)=>e.map((e,r)=>{let a=c({x:n,y:r},t);return a.match?a:void 0})).flat().filter(t=>void 0!=t)}function d(t){return void 0==g(t)}function g(t){for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++){let r={x:e,y:n};for(let a of[{x:e-1,y:n},{x:e+1,y:n},{x:e,y:n-1},{x:e,y:n+1}]){if(a.x<0||a.x>=t.length||a.y<0||a.y>=t[e].length)continue;let u=l(t),o=u[e][n];if(u[e][n]=u[a.x][a.y],u[a.x][a.y]=o,c(r,u).match||c(a,u).match)return[r,a]}}}function p(t){let e=["#0a9396","#e9d8a6","#ee9b00","#ca6702","#005f73","#ae2012","#86350f","#94d2bd","#9b2226"];return t.value>e.length-1?"hsl(".concat((t.value-e.length)*36," 100% 75%)"):e[t.value-1]}function v(t){if(!t.startsWith("#"))return"#101013";let e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);return[e,n,r]=[e,n,r].map(t=>t/255).map(t=>t<=.03928?t/12.92:((t+.055)/1.055)**2.4),.2126*e+.7152*n+.0722*r>.5?"#101050":"#fafafa"}function x(t,e,n,r,a,u){return encodeURIComponent(JSON.stringify({boardNumbers:t.flat().map(t=>t.value),points:e,size:t.length,moves:n,startTime:r,seed:a,duration:u}))}function w(t){var e;let n=JSON.parse(decodeURIComponent(t)),r=n.size,a=n.boardNumbers,o=null!==(e=n.moves)&&void 0!==e?e:0;return{board:Array.from({length:r},(t,e)=>Array.from({length:r},(t,n)=>{let o=e*r+n;return{...u(),value:a[o]}})),points:n.points,size:r,moves:o,startTime:n.startTime,seed:n.seed,duration:n.duration}}function b(t){return{board:(0,r.useMemo)(()=>i(t),[t]),swapTile:s,getTileColor:p,isAdjacent:f,getPositionsThatAlmostMatch:g,isGameOver:d,getTileValue:c}}},6759:function(t,e,n){n.d(e,{gH:function(){return c},getGameHistory:function(){return h},ky:function(){return m},YO:function(){return l},W$:function(){return f},iN:function(){return y},a9:function(){return s},oT:function(){return u},rE:function(){return i}});var r=n(3352),a=n(7565);async function u(t){let{key:e,value:n}=t;await r.u.set({key:e,value:n})}async function o(t){var e;let{key:n}=t,a=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var a=n[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}}(n);return a?(await u({key:n,value:a}),document.cookie="".concat(encodeURIComponent(n),"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"),a):null!==(e=(await r.u.get({key:n})).value)&&void 0!==e?e:void 0}async function i(t){await u({key:"highscore",value:t.toString()})}async function l(){let t=await o({key:"highscore"});return parseInt(null!=t?t:"0")}async function f(){return!!await o({key:"doneTutorial"})}async function c(){await u({key:"doneTutorial",value:"true"})}async function s(t){let e=await o({key:"gameHistory"}),n=e?JSON.parse(e):[];n.push(t),await u({key:"gameHistory",value:JSON.stringify(n)})}async function h(){let t=await o({key:"gameHistory"});if(!t)return[];try{return JSON.parse(t)}catch(t){return[]}}async function y(t,e,n,r,o,i){let l=(0,a.hJ)(t,e,n,r,o,i);await u({key:"gameState",value:l})}async function m(){let t=await o({key:"gameState"});if(t)return(0,a.Pw)(t)}}}]);